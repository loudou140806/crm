!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e,t){function a(){}function n(e,t){var a;return a=t._$container==_?("innerHeight"in s?s.innerHeight:_.height())+_.scrollTop():t._$container.offset().top+t._$container.height(),a<=e.offset().top-t.threshold}function r(t,a){var n;return n=a._$container==_?_.width()+(e.fn.scrollLeft?_.scrollLeft():s.pageXOffset):a._$container.offset().left+a._$container.width(),n<=t.offset().left-a.threshold}function i(e,t){var a;return a=t._$container==_?_.scrollTop():t._$container.offset().top,a>=e.offset().top+t.threshold+e.height()}function o(t,a){var n;return n=a._$container==_?e.fn.scrollLeft?_.scrollLeft():s.pageXOffset:a._$container.offset().left,n>=t.offset().left+a.threshold+t.width()}function l(e,t){var a=0;e.each(function(l,f){function c(){s.trigger("_lazyload_appear"),a=0}var s=e.eq(l);if(!t.skip_invisible||s.width()||s.height()||"none"===s.css("display"))if(t.vertical_only)if(i(s,t));else if(n(s,t)){if(++a>t.failure_limit)return!1}else c();else if(i(s,t)||o(s,t));else if(n(s,t)||r(s,t)){if(++a>t.failure_limit)return!1}else c()})}function f(e){return e.filter(function(t,a){return!e.eq(t)._lazyload_loadStarted})}var c,s=window,_=e(s),d={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:s,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:a,load:a,vertical_only:!1,minimum_interval:300,use_minimum_interval_in_ios:!1,url_rewriter_fn:a,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"},u=/(?:iphone|ipod|ipad).*os/gi.test(navigator.appVersion),p=u&&/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion);c=function(){var e=Object.prototype.toString;return function(t){return e.call(t).replace("[object ","").replace("]","")}}(),e.fn.hasOwnProperty("lazyload")||(e.fn.lazyload=function(t){var n,r,i,o=this,h=null;return e.isPlainObject(t)||(t={}),e.each(d,function(a,n){e.inArray(a,["threshold","failure_limit","minimum_interval"])!=-1?"String"==c(t[a])?t[a]=parseInt(t[a],10):t[a]=n:"container"==a?(t.hasOwnProperty(a)?t[a]==s||t[a]==document?t._$container=_:t._$container=e(t[a]):t._$container=_,delete t.container):!d.hasOwnProperty(a)||t.hasOwnProperty(a)&&c(t[a])==c(d[a])||(t[a]=n)}),n="scroll"==t.event,r=n||"scrollstart"==t.event||"scrollstop"==t.event,o.each(function(n,i){var l=this,c=o.eq(n),s=c.attr("src"),_=c.attr("data-"+t.data_attribute),d=t.url_rewriter_fn==a?_:t.url_rewriter_fn.call(l,c,_),u=c.attr("data-"+t.data_srcset_attribute),p=c.is("img");return 1==c._lazyload_loadStarted||s==d?(c._lazyload_loadStarted=!0,void(o=f(o))):(c._lazyload_loadStarted=!1,p&&!s&&c.one("error",function(){c.attr("src",t.placeholder_real_img)}).attr("src",t.placeholder_data_img),c.one("_lazyload_appear",function(){function n(){r&&c.hide(),p?(u&&c.attr("srcset",u),d&&c.attr("src",d)):c.css("background-image",'url("'+d+'")'),r&&c[t.effect].apply(c,i?t.effect_params:[]),o=f(o)}var r,i=e.isArray(t.effect_params);c._lazyload_loadStarted||(r="show"!=t.effect&&e.fn[t.effect]&&(!t.effect_params||i&&0==t.effect_params.length),t.appear!=a&&t.appear.call(l,o.length,t),c._lazyload_loadStarted=!0,t.no_fake_img_loader||u?(t.load!=a&&c.one("load",function(){t.load.call(l,o.length,t)}),n()):e("<img />").one("load",function(){n(),t.load!=a&&t.load.call(l,o.length,t)}).attr("src",d))}),void(r||c.on(t.event,function(){c._lazyload_loadStarted||c.trigger("_lazyload_appear")})))}),r&&(i=0!=t.minimum_interval,t._$container.on(t.event,function(){return!n||!i||u&&!t.use_minimum_interval_in_ios?l(o,t):void(h||(h=setTimeout(function(){l(o,t),h=null},t.minimum_interval)))})),_.on("resize load",function(){l(o,t)}),p&&_.on("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&o.trigger("_lazyload_appear")}),e(function(){l(o,t)}),this})});