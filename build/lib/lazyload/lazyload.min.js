!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e){function t(){}function a(e,t){var a;return a=t._$container==s?("innerHeight"in c?c.innerHeight:s.height())+s.scrollTop():t._$container.offset().top+t._$container.height(),a<=e.offset().top-t.threshold}function n(t,a){var n;return n=a._$container==s?s.width()+(e.fn.scrollLeft?s.scrollLeft():c.pageXOffset):a._$container.offset().left+a._$container.width(),n<=t.offset().left-a.threshold}function r(e,t){var a;return a=t._$container==s?s.scrollTop():t._$container.offset().top,a>=e.offset().top+t.threshold+e.height()}function i(t,a){var n;return n=a._$container==s?e.fn.scrollLeft?s.scrollLeft():c.pageXOffset:a._$container.offset().left,n>=t.offset().left+a.threshold+t.width()}function o(e,t){var o=0;e.each(function(l){function f(){c.trigger("_lazyload_appear"),o=0}var c=e.eq(l);if(!t.skip_invisible||c.width()||c.height()||"none"===c.css("display"))if(t.vertical_only)if(r(c,t));else if(a(c,t)){if(++o>t.failure_limit)return!1}else f();else if(r(c,t)||i(c,t));else if(a(c,t)||n(c,t)){if(++o>t.failure_limit)return!1}else f()})}function l(e){return e.filter(function(t){return!e.eq(t)._lazyload_loadStarted})}var f,c=window,s=e(c),_={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:c,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:t,load:t,vertical_only:!1,minimum_interval:300,use_minimum_interval_in_ios:!1,url_rewriter_fn:t,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"},d=/(?:iphone|ipod|ipad).*os/gi.test(navigator.appVersion),u=d&&/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion);f=function(){var e=Object.prototype.toString;return function(t){return e.call(t).replace("[object ","").replace("]","")}}(),e.fn.hasOwnProperty("lazyload")||(e.fn.lazyload=function(a){var n,r,i,p=this,h=null;return e.isPlainObject(a)||(a={}),e.each(_,function(t,n){-1!=e.inArray(t,["threshold","failure_limit","minimum_interval"])?a[t]="String"==f(a[t])?parseInt(a[t],10):n:"container"==t?(a._$container=a.hasOwnProperty(t)?a[t]==c||a[t]==document?s:e(a[t]):s,delete a.container):!_.hasOwnProperty(t)||a.hasOwnProperty(t)&&f(a[t])==f(_[t])||(a[t]=n)}),n="scroll"==a.event,r=n||"scrollstart"==a.event||"scrollstop"==a.event,p.each(function(n){var i=this,o=p.eq(n),f=o.attr("src"),c=o.attr("data-"+a.data_attribute),s=a.url_rewriter_fn==t?c:a.url_rewriter_fn.call(i,o,c),_=o.attr("data-"+a.data_srcset_attribute),d=o.is("img");return 1==o._lazyload_loadStarted||f==s?(o._lazyload_loadStarted=!0,void(p=l(p))):(o._lazyload_loadStarted=!1,d&&!f&&o.one("error",function(){o.attr("src",a.placeholder_real_img)}).attr("src",a.placeholder_data_img),o.one("_lazyload_appear",function(){function n(){r&&o.hide(),d?(_&&o.attr("srcset",_),s&&o.attr("src",s)):o.css("background-image",'url("'+s+'")'),r&&o[a.effect].apply(o,f?a.effect_params:[]),p=l(p)}var r,f=e.isArray(a.effect_params);o._lazyload_loadStarted||(r="show"!=a.effect&&e.fn[a.effect]&&(!a.effect_params||f&&0==a.effect_params.length),a.appear!=t&&a.appear.call(i,p.length,a),o._lazyload_loadStarted=!0,a.no_fake_img_loader||_?(a.load!=t&&o.one("load",function(){a.load.call(i,p.length,a)}),n()):e("<img />").one("load",function(){n(),a.load!=t&&a.load.call(i,p.length,a)}).attr("src",s))}),void(r||o.on(a.event,function(){o._lazyload_loadStarted||o.trigger("_lazyload_appear")})))}),r&&(i=0!=a.minimum_interval,a._$container.on(a.event,function(){return!n||!i||d&&!a.use_minimum_interval_in_ios?o(p,a):void(h||(h=setTimeout(function(){o(p,a),h=null},a.minimum_interval)))})),s.on("resize load",function(){o(p,a)}),u&&s.on("pageshow",function(e){e.originalEvent&&e.originalEvent.persisted&&p.trigger("_lazyload_appear")}),e(function(){o(p,a)}),this})});